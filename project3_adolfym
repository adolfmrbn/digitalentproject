# Number 1: Encrypting text
def caesar_encript(txt,shift):
  letter = 'abcdefghijklmnopqrstuvwxyz'
  Letter = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  cipher_ = ''

  for char in txt:
    if char in letter:# check if char in letter
      code = chr((ord(char) + shift - 97)%26 + 97) # ord('a')
      cipher_ += code
    elif char in Letter:
      code = chr((ord(char) + shift - 65)%26 + 65) # ord('A')
      cipher_ += code
    else:
      cipher_ += char

  return cipher_
    
# Decrypting Caesar
def caesar_decript(chiper,shift):
  return caesar_encript(chiper,-shift)
  
# Output check
msg = 'Haloz DTS mania, MANTAPSZZZ!'
cpr = caesar_encript(msg,4)
txt = caesar_decript(cpr,4)

print('plain text:',txt)
print('chiper text:',cpr)

# Number 2
# Function to shuffle text
def shuffle_order(txt, order):
  return ''.join([txt[i] for i in order])
 
# Function to deshuffle text
def deshuffle_order(sftxt, order):
  return ''.join([sftxt[order.index(i)] for i in range(len(order))])
  
# Output check
print(shuffle_order('abcd', [2,1,3,0]))
print(deshuffle_order('cbda', [2,1,3,0]))

# Number 3
import math
 
# convert text into batches
# encrypted and shuffled
def send_batch(txt, batch_order, shift=3):
  n = len(batch_order)
  split_text = []
  if len(txt)%n == 0:
    for i in range(0, len(txt), n):
      split_text.append(txt[i:i+n])

    encrypt = []
    for each in range(len(split_text)):
      encrypt_txt = caesar_encript(split_text[each], shift)
      encrypt_txt_sf = shuffle_order(encrypt_txt, batch_order)
      encrypt.append(encrypt_txt_sf)
      
  else:
    len_sisa = n - (len(txt) + n)%n
    txt_new = txt + '_'*len_sisa
    for i in range(0, len(txt_new), n):
      split_text.append(txt_new[i:i+n])
    
    encrypt = []
    for each in range(len(split_text)):
      encrypt_txt = caesar_encript(split_text[each], shift)
      encrypt_txt_sf = shuffle_order(encrypt_txt, batch_order)
      encrypt.append(encrypt_txt_sf)

  return encrypt

# batch_cpr: send_batch list output
# this function will return unshuffled text
def receive_batch(batch_cpr, batch_order, shift=3):
  batch_txt = [caesar_decript(deshuffle_order(i, batch_order), shift) for i in batch_cpr]
  return ''.join(batch_txt).strip('_')
  
# Output check
msg_cpr = send_batch('halo DTS mania, mantaaap!!!', [2,1,3,0], 4)
msg_txt = receive_batch(msg_cpr, [2,1,3,0], 4)
print(msg_txt, msg_cpr,sep='\n')
